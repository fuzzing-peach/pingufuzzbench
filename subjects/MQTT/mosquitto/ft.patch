diff --git a/CMakeLists.txt b/CMakeLists.txt
index 9e1c58d1..fd4f65bc 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -32,6 +32,7 @@ option(WITH_TLS_PSK
 option(WITH_EC
 	"Include Elliptic Curve support (requires WITH_TLS)?" ON)
 if (WITH_TLS)
+    set(OPENSSL_USE_STATIC_LIBS TRUE)
 	find_package(OpenSSL REQUIRED)
 	add_definitions("-DWITH_TLS")
 
diff --git a/include/mosquitto.h b/include/mosquitto.h
index 7c80c8b0..6cdf870b 100644
--- a/include/mosquitto.h
+++ b/include/mosquitto.h
@@ -1273,6 +1273,8 @@ libmosq_EXPORT int mosquitto_loop_forever(struct mosquitto *mosq, int timeout, i
  */
 libmosq_EXPORT int mosquitto_loop_start(struct mosquitto *mosq);
 
+libmosq_EXPORT void mosquitto_loop_join(struct mosquitto *mosq);
+
 /*
  * Function: mosquitto_loop_stop
  *
diff --git a/lib/CMakeLists.txt b/lib/CMakeLists.txt
index 21b61497..ebae6050 100644
--- a/lib/CMakeLists.txt
+++ b/lib/CMakeLists.txt
@@ -60,7 +60,9 @@ set(C_SRC
 	util_mosq.c util_topic.c util_mosq.h
 	will_mosq.c will_mosq.h)
 
-set (LIBRARIES OpenSSL::SSL)
+if (WITH_TLS)
+	set (LIBRARIES OpenSSL:SSL)
+endif (WITH_TLS)
 
 if (UNIX AND NOT APPLE AND NOT ANDROID)
 	find_library(LIBRT rt)
diff --git a/lib/net_mosq.c b/lib/net_mosq.c
index d9eb81e0..e2193c57 100644
--- a/lib/net_mosq.c
+++ b/lib/net_mosq.c
@@ -762,7 +762,11 @@ static int net__init_ssl_ctx(struct mosquitto *mosq)
 			if(mosq->tls_cert_reqs == 0){
 				SSL_CTX_set_verify(mosq->ssl_ctx, SSL_VERIFY_NONE, NULL);
 			}else{
+#ifdef FT_FUZZING
+				SSL_CTX_set_verify(mosq->ssl_ctx, SSL_VERIFY_NONE, NULL);
+#else
 				SSL_CTX_set_verify(mosq->ssl_ctx, SSL_VERIFY_PEER, mosquitto__server_certificate_verify);
+#endif
 			}
 
 			if(mosq->tls_pw_callback){
diff --git a/lib/thread_mosq.c b/lib/thread_mosq.c
index cd3a614a..2f499b13 100644
--- a/lib/thread_mosq.c
+++ b/lib/thread_mosq.c
@@ -36,6 +36,10 @@ Contributors:
 
 void *mosquitto__thread_main(void *obj);
 
+void mosquitto_loop_join(struct mosquitto *mosq) {
+    pthread_join(mosq->thread_id, NULL);
+}
+
 int mosquitto_loop_start(struct mosquitto *mosq)
 {
 #if defined(WITH_THREADING)
diff --git a/lib/util_mosq.c b/lib/util_mosq.c
index bed940b4..3956fd35 100644
--- a/lib/util_mosq.c
+++ b/lib/util_mosq.c
@@ -21,6 +21,7 @@ Contributors:
 #include <assert.h>
 #include <ctype.h>
 #include <string.h>
+#include <string.h>
 
 #ifdef WIN32
 #  include <winsock2.h>
@@ -248,6 +249,10 @@ void util__decrement_send_quota(struct mosquitto *mosq)
 
 int util__random_bytes(void *bytes, int count)
 {
+#ifdef FT_FUZZING
+	memset(bytes, 0xcc, count);
+	return MOSQ_ERR_SUCCESS;
+#endif
 	int rc = MOSQ_ERR_UNKNOWN;
 
 #ifdef WITH_TLS
diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index d4bae7cd..d8e6f5dc 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -163,7 +163,11 @@ if (WITH_DLT)
     set (MOSQ_LIBS ${MOSQ_LIBS} ${DLT_LIBRARIES})
 endif (WITH_DLT)
 
-set (MOSQ_LIBS ${MOSQ_LIBS} OpenSSL::SSL)
+if (WITH_TLS)
+	set (MOSQ_LIBS ${MOSQ_LIBS} OpenSSL:SSL)
+else (WITH_TLS)
+	set (MOSQ_LIBS ${MOSQ_LIBS})
+endif (WITH_TLS)
 # Check for getaddrinfo_a
 include(CheckLibraryExists)
 check_library_exists(anl getaddrinfo_a  "" HAVE_GETADDRINFO_A)
diff --git a/src/loop.c b/src/loop.c
index 26bc44d7..fcfe1b5b 100644
--- a/src/loop.c
+++ b/src/loop.c
@@ -368,10 +368,11 @@ void do_disconnect(struct mosquitto *context, int reason)
 					log__printf(NULL, MOSQ_LOG_NOTICE, "Client %s disconnected.", id);
 				}
 			}
+#if defined(FT_FUZZING) && !defined(SGFUZZ)
+				exit(0);
+#endif
 		}
 		mux__delete(context);
 		context__disconnect(context);
 	}
 }
-
-
diff --git a/src/mosquitto.c b/src/mosquitto.c
index 50d50d26..c396d0d6 100644
--- a/src/mosquitto.c
+++ b/src/mosquitto.c
@@ -450,8 +450,7 @@ static int pid__write(void)
 	return MOSQ_ERR_SUCCESS;
 }
 
-
-int main(int argc, char *argv[])
+int main(int argc, char ** argv)
 {
 	struct mosquitto__config config;
 #ifdef WITH_BRIDGE
